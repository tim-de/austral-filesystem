
import Standard.Buffer (
    Buffer
);

import FileSystem (
    FileSystemCapability
);

module FileSystem.File is
    
    type FileHandle: Linear;
    
    generic [R: Region, Q: Region, P: Region]
    function open(fs: &![FileSystemCapability, R], pathname: Span[Nat8, Q], mode: Span[Nat8, P]): Option[FileHandle];

    function close(fh: FileHandle): Unit;

    generic [R: Region]
    function read(fh: &[FileHandle, R], count: Index): Buffer[Nat8];

    generic [R: Region]
    function readSafe(fh: &[FileHandle, R], count: Index): Option[Buffer[Nat8]];

    generic [R: Region, Q: Region]
    function write(fh: &![FileHandle, R], buf: Span[Nat8, Q]): Index;

end module.
